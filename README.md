# Lecture # 1 - Intro to Flask

## Lecture Topics

- How the Web Works
- Web Servers
- Creating a Flask Application
- Flask Routing and Views
- Flask Application Structure

## Key Vocab

- Web Server: a combination of software and hardware that uses Hypertext Transfer Protocol (HTTP) and other protocols to respond to requests made over the internet.
- Routing: Routing is the association of URLs and the code that should execute when a request comes in for that URL.
- Views: We call functions that map to URLs views. Everything you view in your application is generated by a view.

## Setup

1. Make sure that you are in the correct directory (folder) that contains a `Pipfile`, then enter the command `pipenv install` in your terminal to install the required packages.

2. Now that your `pipenv` virtual environment is ready to use, enter the command `pipenv shell` in your terminal to enter the virtual environment.

3. Enter the command `cd server` in your terminal to move into the server directory.

## Code Along

We will be writing our code in the `app.py` file in the `server` directory (folder):

1. Write the following code after line 1 in `app.py`:

```py
from flask import Flask
```

This will import the `Flask` class so that we can use it to create an instance of the `Flask` class to start our Flask application.

2. Write the following code on the next line in `app.py`:

```py
app = Flask(__name__)
```

This will create an instance of the `Flask` class so that we can use it to start our Flask application.

3. Write the following code on the next line in `app.py` which will create our first route and view:

```py
@app.route('/')
def index():
    return '<h1>Welcome to my website!</h1>'
```

The `index()` view will return a string containing code for a HTML header element that says "Welcome to my website!"

4. To run the application that we created in this lesson, we need to run three terminal commands inside of our `pipenv` virtual environment. We should ideally run these commands from the `server` directory where the `app.py` file is located. Enter the following commands in your terminal while inside of the `server` directory:

```
export FLASK_APP=app.py

export FLASK_RUN_PORT=7777

flask run
```

`export FLASK_APP=app.py` specifies that your Flask app is located in the `app.py` file within the current directory.

`export FLASK_RUN_PORT=7777` allows you to run your Flask app on port 7777.

`flask run` is a command run from the terminal that looks for the name of the Python module with our Flask application instance and runs the Flask app.

5. Navigate to `http://127.0.0.1:7777` and you should see a page that says "Welcome to my website!" We were able to create a basic webpage using a Flask route and view! By the way, on many computers, `localhost` is an alias for the IP address `127.0.0.1`, so `http://localhost:7777` works as well.

6. We can also run a development server through treating our application module as a script with the `app.run()` method. Write the following code in `app.py` after the code for the `index()` view function:

```py
if __name__ == "__main__":
    app.run(port=7777, debug=True)
```

7. Enter the following command in the terminal to run the script and you should see that we're running the same server as before, but with `Debug mode` set to `on`:

```
python app.py
```

8. If you want to set `Debug mode` to `on` when running the `flask run` command in the terminal, you can run the following command in the terminal, while inside of the `server` directory:

```
flask run --debug
```

This will allow the Flask app to detect changes to your code in `app.py` that would affect the Flask app (changes to the app's routes, views, etc) after saving those changes.

9. Write the following code in `app.py` after the code for the `index()` view function (but before the `if __name__ == "__main__"` code) which will create another route and view:

```py
@app.route('/another_page')
def different_page():
    return '<h1>This is another page!</h1>'
```

The `different_page()` view will return a string containing code for a HTML header element that says "This is another page!" You will be able to view this content when you visit `http://127.0.0.1:7777/another_page` (or `http://localhost:7777/another_page`)

10. Write the following code in `app.py` after the code for the `different_page()` view function (but before the `if __name__ == "__main__"` code) which will create a route and view where the route takes in a parameter `<name>`:

```py
@app.route('/intro/<name>')
def intro(name):
    return f"<h1>Hi! My name is {name}.</h1>"
```

Note that the `<` and `>` characters around `name` are what make `name` into a parameter for the route. That means that whatever value we enter into the URL path after `/intro/` will be passed in as an argument into the `name` parameter for the `intro()` view function that the route is associated with. Try visiting `http://127.0.0.1:7777/intro/Alice` and then try visiting `http://127.0.0.1:7777/intro/Bob` and notice the differences when visiting each page. The page will display a different name depending on the value for the `<name>` parameter! That's also thanks to our use of string interpolation in this example.

There must be a parameter with the name of `name` for the `intro()` view function since the associated route passed in a parameter with the name of `name` in this case. If not, we will get an error `TypeError: intro() got an unexpected keyword argument 'name'.` that shows up in the browser when we try to view this content when visiting the route's URL.

By default, all parameters passed in will have the `str` data type. A view can receive more than 1 parameter, as can be seen in the next example.

11. Write the following code in `app.py` after the code for the `intro()` view function (but before the `if __name__ == "__main__"` code) which will create a route and view where the route takes in two parameters `<name>` and `<int:age>`:

```py
@app.route('/intro/<name>/<int:age>')
def intro_2(name, age):
    return f"<h1>Hi! My name is {name}. I'm {age} years old!</h1>"
```

It's almost the same idea here, except that we're doing something different for the second parameter, `<age>`. Notice that there's an `int:` just before `age>`. This use of `int:` allows you to change the data type of the parameter to an integer. We can change the data type of a parameter from its default `str` data type to the data type specified before the `:`. So in this case, the value of `age` is converted to an integer. Just remember that we'll need to supply an integer value for the `age` parameter in order change the parameter value's data type to an integer.

If we want to change a parameter's data type to `float`, we'd need to enter a float value into the URL, otherwise the route will not interpret the value as a `float`.

```py
@app.route('/<float:number>')
def float_example(number):
    return f"<h1>The number is {number}</h1>"
```

```
Example # 1 URL: http://127.0.0.1:7777/4

Result: Not Found

The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
```

```
Example # 2 URL: http://127.0.0.1:7777/4.0

Result: The number is 4.0
```

## Deliverables

1. Create a `greeting()` view that takes two parameters, both of which are strings. The route for this view should be of the format `/greeting/<first_name>/<last_name>`. The view should return an `h1` element that contains text of the format `Greetings, {first_name} {last_name}!` where `first_name` represents a person's first name, and `last_name` represents a person's last name.

2. Create a `count_and_square()` view that takes one parameter, an integer. The route for this view should be of the format `/count_and_square/<number>`. For all numbers in the `range` of that parameter, the view should return a string that contains those numbers squared on separate lines. For example, if the parameter has the value of `4`, the view should return a string that display the values of `1`, `4`, `9`, and `16` on separate lines since that would be the result of squaring the numbers `1`, `2`, `3`, and `4` where the range is from `1 - 4`, including `4`.